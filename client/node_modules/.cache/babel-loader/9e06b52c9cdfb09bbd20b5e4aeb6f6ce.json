{"ast":null,"code":"import{useEffect,useState}from\"react\";import{useParams}from\"react-router-dom\";import useEth from\"../contexts/EthContext/useEth\";import OwnerDetail from\"./OwnerDetail\";import VoterDetail from\"./VoterDetail\";import Box from\"@mui/material/Box\";import Backdrop from\"@mui/material/Backdrop\";import CircularProgress from\"@mui/material/CircularProgress\";import Typography from\"@mui/material/Typography\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ElectionDetail(_ref){let{color=\"primary\"}=_ref;const{id}=useParams();const[title,setTitle]=useState(\"\");const{state:{contract,accounts}}=useEth();const[candidates,setCandidates]=useState(null);const[loading,setLoading]=useState(true);const[isOwner,setIsOwner]=useState(null);useEffect(()=>{const getRole=async()=>{if(contract){const isOwner=await contract.methods.isOwner(id).call({from:accounts[0]});setIsOwner(isOwner);}};const getCandidates=async()=>{if(contract){const candidates=await contract.methods.getCandidates(id).call();setCandidates(candidates);}};const getTitle=async()=>{if(contract){const title=await contract.methods.getElectionTitle(id).call();setTitle(title);setLoading(false);}};getRole();getCandidates();getTitle();},[contract,accounts,id,title]);return/*#__PURE__*/_jsx(Box,{sx:{bgcolor:\"background.default\",color:\"text.primary\",height:\"100vh\"},children:loading?/*#__PURE__*/_jsx(Backdrop,{sx:{color:\"#fff\",zIndex:theme=>theme.zIndex.drawer+1},open:true,children:/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\"})}):/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Box,{marginTop:4,children:/*#__PURE__*/_jsx(Typography,{sx:{color:theme=>theme.palette[color].darker},align:\"center\",variant:\"h4\",children:title})}),isOwner&&/*#__PURE__*/_jsx(OwnerDetail,{id:id,title:title,candidates:candidates,isOwner:isOwner,contract:contract,currentAccount:accounts[0]}),!isOwner&&/*#__PURE__*/_jsx(VoterDetail,{id:id,isOwner:isOwner,title:title,candidates:candidates,contract:contract,currentAccount:accounts[0]})]})});}","map":{"version":3,"names":["useEffect","useState","useParams","useEth","OwnerDetail","VoterDetail","Box","Backdrop","CircularProgress","Typography","jsx","_jsx","jsxs","_jsxs","ElectionDetail","_ref","color","id","title","setTitle","state","contract","accounts","candidates","setCandidates","loading","setLoading","isOwner","setIsOwner","getRole","methods","call","from","getCandidates","getTitle","getElectionTitle","sx","bgcolor","height","children","zIndex","theme","drawer","open","marginTop","palette","darker","align","variant","currentAccount"],"sources":["C:/Users/HongYaeJIn/Desktop/yaejin/과제/2023/web2/blockvote-polygon-hackathon/client/src/screens/ElectionDetail.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nimport useEth from \"../contexts/EthContext/useEth\";\r\n\r\nimport OwnerDetail from \"./OwnerDetail\";\r\nimport VoterDetail from \"./VoterDetail\";\r\n\r\nimport Box from \"@mui/material/Box\";\r\nimport Backdrop from \"@mui/material/Backdrop\";\r\nimport CircularProgress from \"@mui/material/CircularProgress\";\r\nimport Typography from \"@mui/material/Typography\";\r\n\r\nexport default function ElectionDetail({ color = \"primary\" }) {\r\n\tconst { id } = useParams();\r\n\tconst [title, setTitle] = useState(\"\");\r\n\tconst {\r\n\t\tstate: { contract, accounts },\r\n\t} = useEth();\r\n\tconst [candidates, setCandidates] = useState(null);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [isOwner, setIsOwner] = useState(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst getRole = async () => {\r\n\t\t\tif (contract) {\r\n\t\t\t\tconst isOwner = await contract.methods\r\n\t\t\t\t\t.isOwner(id)\r\n\t\t\t\t\t.call({ from: accounts[0] });\r\n\t\t\t\tsetIsOwner(isOwner);\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst getCandidates = async () => {\r\n\t\t\tif (contract) {\r\n\t\t\t\tconst candidates = await contract.methods\r\n\t\t\t\t\t.getCandidates(id)\r\n\t\t\t\t\t.call();\r\n\t\t\t\tsetCandidates(candidates);\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst getTitle = async () => {\r\n\t\t\tif (contract) {\r\n\t\t\t\tconst title = await contract.methods\r\n\t\t\t\t\t.getElectionTitle(id)\r\n\t\t\t\t\t.call();\r\n\t\t\t\tsetTitle(title);\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t};\r\n\t\tgetRole();\r\n\t\tgetCandidates();\r\n\t\tgetTitle();\r\n\t}, [contract, accounts, id, title]);\r\n\r\n\treturn (\r\n\t\t<Box\r\n\t\t\tsx={{\r\n\t\t\t\tbgcolor: \"background.default\",\r\n\t\t\t\tcolor: \"text.primary\",\r\n\t\t\t\theight: \"100vh\",\r\n\t\t\t}}>\r\n\t\t\t{loading ? (\r\n\t\t\t\t<Backdrop\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tcolor: \"#fff\",\r\n\t\t\t\t\t\tzIndex: (theme) => theme.zIndex.drawer + 1,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\topen={true}>\r\n\t\t\t\t\t<CircularProgress color=\"inherit\" />\r\n\t\t\t\t</Backdrop>\r\n\t\t\t) : (\r\n\t\t\t\t<Box>\r\n\t\t\t\t\t<Box marginTop={4}>\r\n\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\t\tcolor: (theme) => theme.palette[color].darker,\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\talign=\"center\"\r\n\t\t\t\t\t\t\tvariant=\"h4\">\r\n\t\t\t\t\t\t\t{title}\r\n\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t</Box>\r\n\t\t\t\t\t{isOwner && (\r\n\t\t\t\t\t\t<OwnerDetail\r\n\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\ttitle={title}\r\n\t\t\t\t\t\t\tcandidates={candidates}\r\n\t\t\t\t\t\t\tisOwner={isOwner}\r\n\t\t\t\t\t\t\tcontract={contract}\r\n\t\t\t\t\t\t\tcurrentAccount={accounts[0]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{!isOwner && (\r\n\t\t\t\t\t\t<VoterDetail\r\n\t\t\t\t\t\t\tid={id}\r\n\t\t\t\t\t\t\tisOwner={isOwner}\r\n\t\t\t\t\t\t\ttitle={title}\r\n\t\t\t\t\t\t\tcandidates={candidates}\r\n\t\t\t\t\t\t\tcontract={contract}\r\n\t\t\t\t\t\t\tcurrentAccount={accounts[0]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Box>\r\n\t\t\t)}\r\n\t\t</Box>\r\n\t);\r\n}\r\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,OAASC,SAAS,KAAQ,kBAAkB,CAE5C,MAAO,CAAAC,MAAM,KAAM,+BAA+B,CAElD,MAAO,CAAAC,WAAW,KAAM,eAAe,CACvC,MAAO,CAAAC,WAAW,KAAM,eAAe,CAEvC,MAAO,CAAAC,GAAG,KAAM,mBAAmB,CACnC,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAC7C,MAAO,CAAAC,gBAAgB,KAAM,gCAAgC,CAC7D,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAElD,cAAe,SAAS,CAAAC,cAAcA,CAAAC,IAAA,CAAwB,IAAvB,CAAEC,KAAK,CAAG,SAAU,CAAC,CAAAD,IAAA,CAC3D,KAAM,CAAEE,EAAG,CAAC,CAAGf,SAAS,CAAC,CAAC,CAC1B,KAAM,CAACgB,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CACLmB,KAAK,CAAE,CAAEC,QAAQ,CAAEC,QAAS,CAC7B,CAAC,CAAGnB,MAAM,CAAC,CAAC,CACZ,KAAM,CAACoB,UAAU,CAAEC,aAAa,CAAC,CAAGvB,QAAQ,CAAC,IAAI,CAAC,CAClD,KAAM,CAACwB,OAAO,CAAEC,UAAU,CAAC,CAAGzB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAC0B,OAAO,CAAEC,UAAU,CAAC,CAAG3B,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACf,KAAM,CAAA6B,OAAO,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAIR,QAAQ,CAAE,CACb,KAAM,CAAAM,OAAO,CAAG,KAAM,CAAAN,QAAQ,CAACS,OAAO,CACpCH,OAAO,CAACV,EAAE,CAAC,CACXc,IAAI,CAAC,CAAEC,IAAI,CAAEV,QAAQ,CAAC,CAAC,CAAE,CAAC,CAAC,CAC7BM,UAAU,CAACD,OAAO,CAAC,CACpB,CACD,CAAC,CACD,KAAM,CAAAM,aAAa,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAIZ,QAAQ,CAAE,CACb,KAAM,CAAAE,UAAU,CAAG,KAAM,CAAAF,QAAQ,CAACS,OAAO,CACvCG,aAAa,CAAChB,EAAE,CAAC,CACjBc,IAAI,CAAC,CAAC,CACRP,aAAa,CAACD,UAAU,CAAC,CAC1B,CACD,CAAC,CACD,KAAM,CAAAW,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAIb,QAAQ,CAAE,CACb,KAAM,CAAAH,KAAK,CAAG,KAAM,CAAAG,QAAQ,CAACS,OAAO,CAClCK,gBAAgB,CAAClB,EAAE,CAAC,CACpBc,IAAI,CAAC,CAAC,CACRZ,QAAQ,CAACD,KAAK,CAAC,CACfQ,UAAU,CAAC,KAAK,CAAC,CAClB,CACD,CAAC,CACDG,OAAO,CAAC,CAAC,CACTI,aAAa,CAAC,CAAC,CACfC,QAAQ,CAAC,CAAC,CACX,CAAC,CAAE,CAACb,QAAQ,CAAEC,QAAQ,CAAEL,EAAE,CAAEC,KAAK,CAAC,CAAC,CAEnC,mBACCP,IAAA,CAACL,GAAG,EACH8B,EAAE,CAAE,CACHC,OAAO,CAAE,oBAAoB,CAC7BrB,KAAK,CAAE,cAAc,CACrBsB,MAAM,CAAE,OACT,CAAE,CAAAC,QAAA,CACDd,OAAO,cACPd,IAAA,CAACJ,QAAQ,EACR6B,EAAE,CAAE,CACHpB,KAAK,CAAE,MAAM,CACbwB,MAAM,CAAGC,KAAK,EAAKA,KAAK,CAACD,MAAM,CAACE,MAAM,CAAG,CAC1C,CAAE,CACFC,IAAI,CAAE,IAAK,CAAAJ,QAAA,cACX5B,IAAA,CAACH,gBAAgB,EAACQ,KAAK,CAAC,SAAS,CAAE,CAAC,CAC3B,CAAC,cAEXH,KAAA,CAACP,GAAG,EAAAiC,QAAA,eACH5B,IAAA,CAACL,GAAG,EAACsC,SAAS,CAAE,CAAE,CAAAL,QAAA,cACjB5B,IAAA,CAACF,UAAU,EACV2B,EAAE,CAAE,CACHpB,KAAK,CAAGyB,KAAK,EAAKA,KAAK,CAACI,OAAO,CAAC7B,KAAK,CAAC,CAAC8B,MACxC,CAAE,CACFC,KAAK,CAAC,QAAQ,CACdC,OAAO,CAAC,IAAI,CAAAT,QAAA,CACXrB,KAAK,CACK,CAAC,CACT,CAAC,CACLS,OAAO,eACPhB,IAAA,CAACP,WAAW,EACXa,EAAE,CAAEA,EAAG,CACPC,KAAK,CAAEA,KAAM,CACbK,UAAU,CAAEA,UAAW,CACvBI,OAAO,CAAEA,OAAQ,CACjBN,QAAQ,CAAEA,QAAS,CACnB4B,cAAc,CAAE3B,QAAQ,CAAC,CAAC,CAAE,CAC5B,CACD,CAEA,CAACK,OAAO,eACRhB,IAAA,CAACN,WAAW,EACXY,EAAE,CAAEA,EAAG,CACPU,OAAO,CAAEA,OAAQ,CACjBT,KAAK,CAAEA,KAAM,CACbK,UAAU,CAAEA,UAAW,CACvBF,QAAQ,CAAEA,QAAS,CACnB4B,cAAc,CAAE3B,QAAQ,CAAC,CAAC,CAAE,CAC5B,CACD,EACG,CACL,CACG,CAAC,CAER"},"metadata":{},"sourceType":"module"}